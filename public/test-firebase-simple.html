<!DOCTYPE html>
<html>
<head>
    <title>Firebase Breaking News Test</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, query, where, getDocs, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: 'AIzaSyCywwj_27AOLJVq_hrhArfN--k1eStHOdA',
            authDomain: 'mobilegames-win.firebaseapp.com',
            projectId: 'mobilegames-win',
            storageBucket: 'mobilegames-win.firebasestorage.app',
            messagingSenderId: '1055853638509',
            appId: '1:1055853638509:web:e7fb57c0e2e8d7c0b7c9b5',
        };

        console.log('üî• Initializing Firebase...');
        const app = initializeApp(firebaseConfig);
        console.log('‚úÖ Firebase initialized');

        const db = getFirestore(app);
        console.log('üóÑÔ∏è Firestore instance created');

        async function testBreakingNews() {
            try {
                console.log('üîç Fetching breaking news...');
                const newsRef = collection(db, 'breaking_news');
                const q = query(
                    newsRef,
                    where('active', '==', true),
                    orderBy('createdAt', 'desc'),
                    limit(1)
                );

                const querySnapshot = await getDocs(q);
                console.log('üì∞ Query result:', querySnapshot.size, 'documents');

                if (!querySnapshot.empty) {
                    const doc = querySnapshot.docs[0];
                    const newsData = { id: doc.id, ...doc.data() };
                    console.log('‚úÖ Breaking news found:', newsData);
                    document.getElementById('result').innerHTML = `
                        <h2 style="color: green;">‚úÖ SUCCESS</h2>
                        <p><strong>Title:</strong> ${newsData.title}</p>
                        <p><strong>Content:</strong> ${newsData.content}</p>
                        <p><strong>Active:</strong> ${newsData.active}</p>
                        <p><strong>Created:</strong> ${newsData.createdAt?.toDate?.() || newsData.createdAt}</p>
                    `;
                } else {
                    console.log('‚ö†Ô∏è No active breaking news found');
                    document.getElementById('result').innerHTML = '<h2 style="color: orange;">‚ö†Ô∏è No active breaking news found</h2>';
                }
            } catch (error) {
                console.error('‚ùå Error fetching breaking news:', error);
                document.getElementById('result').innerHTML = `
                    <h2 style="color: red;">‚ùå ERROR</h2>
                    <p>${error.message}</p>
                    <pre>${JSON.stringify(error, null, 2)}</pre>
                `;
            }
        }

        // Run test when page loads
        window.addEventListener('load', testBreakingNews);
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        #result {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        pre {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üß™ Firebase Breaking News Test</h1>
    <p>Testing direct Firebase connection from browser...</p>
    <p>Open browser console (F12) to see detailed logs.</p>
    <div id="result">
        <p>‚è≥ Loading...</p>
    </div>
</body>
</html>
